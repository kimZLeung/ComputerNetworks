## 路由协议

生成路由控制表的协议

- RIP
- OSPF
- BGP

---

### RIP

- 距离向量算法的路由协议
- 通过跳数区分路由距离

> 缺点：路由A与网络A断开时，容易产生无限计数问题。每30秒广播路由信息浪费网络流量

解决无限计数问题：

- 限制16跳。
- 水平分割：不再把所受到的路由消息原路返还给发送端。

但是还会有环路问题

- 解决：
  - 毒性逆转：发现断开时发送一个距离为16的消息。即不可达的意思。
  - 触发更新：路由信息发生变化时不等待30秒，而是立即发送

---

### OSPF

- 链路状态型路由协议
- 每个路由器交换链路状态，每个路由器都有一个拓扑数据库用于保存网络的拓扑状态
- 相比于RIP来说，可以自定义每个链路的权重（即通过这个路由转发的代价），而不是使用跳数，这样做更加精准地建立更快的路由表

OSPF的五种包：

- 问候：确认相邻路由器
- 数据库描述：这个网络拓扑状态的版本
- 链路状态请求：请求从数据库中获取链路状态信息
- 链路状态更新：更新链路状态数据库中的链路状态信息
- 链路状态确认应答：链路状态信息更新的确认应答

> 当网络的拓扑状态更新，就会以泛洪法更新。发送一个链路状态更新的包，使各个路由的拓扑数据库更新

随着网络越来越大，OSPF也不可能把每个路由器里的路由控制表建的很大。

所以引入了AS的概念。AS就是自治区域。每个AS里面的内部路由器只了解该区域内部的链路状态信息，并且计算出路由控制表。

这样做可以有效减少路由控制信息，还能减轻处理的负担。

---

### BGP

---

**建立了路由控制表之后**，路由器也是根据这个表转发的，但是转发时会遵循最长匹配原则。